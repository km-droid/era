#!/bin/bash

PROJECT_ID="your-project-id"
REGION="us-central1"   # change to your region
INPUT_FILE="instances.txt"

while IFS= read -r INSTANCE_NAME; do
  echo "Checking instance: $INSTANCE_NAME"

  # Grab only the key fields
  OUTPUT=$(gcloud notebooks instances describe "$INSTANCE_NAME" \
    --project="$PROJECT_ID" \
    --location="$REGION" \
    --format="yaml(vmImage,containerImage,proxyUri)")

  echo "$OUTPUT"

  # Simple classification
  if echo "$OUTPUT" | grep -q "vmImage:"; then
    echo "→ $INSTANCE_NAME is USER-MANAGED (GCE VM)"
  elif echo "$OUTPUT" | grep -q "containerImage:"; then
    echo "→ $INSTANCE_NAME is MANAGED (Google container runtime)"
  else
    echo "→ Could not determine type"
  fi

  echo "--------------------------------"
done < "$INPUT_FILE"
